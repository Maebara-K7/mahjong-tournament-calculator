# 日麻终局状况计算器 (Riichi Mahjong Condition Calculator)

这是一个基于 Python 的命令行工具，专门用于计算日本麻将（特别是比赛规则）在特定对局状况下，各家为了达成特定顺位目标的和牌、放铳及流局条件。

对于需要精确计算点差和顺位的竞技麻将玩家和解说来说，这是一个强大而精准的辅助工具。

## 核心功能

- **主动和牌条件**:
  - **自摸 (Tsumo)**: 计算玩家需要自摸多大的牌（例如 `2000/4000`）才能达成目标顺位。
  - **荣和 (Ron)**: 计算玩家需要荣和某位对手多大的牌才能达成目标顺位。

- **被动安全条件**:
  - **被自摸 (Passive Tsumo)**: 计算在对手自摸多大的牌以内，自己仍然能保持在目标顺位。
  - **放铳 (Passive Ron)**: 计算自己放铳给某位对手多大的牌以内，仍然能保持在目标顺位。

- **流局条件 (Ryuukyoku)**:
  - 分析在流局时，自己听牌或不听牌，以及其他对手的听牌组合，对最终顺位的影响。

- **规则高度可配置**:
  - 通过 `rulesets.py` 文件预设了多种主流规则集（如 M-League、天凤等）。
  - 轻松区分对局终了和连庄续行两种情况下的不同条件。

## 项目结构与必需文件

要运行此项目，请确保以下核心文件位于同一目录下：

1.  `main.py`: **主程序入口**。用于对特定场景进行精确计算。
2.  `practice.py`: **交互式练习工具**。用于随机生成题目并进行状况计算练习。
3.  `calculation.py`: **核心计算模块**。包含了所有复杂博弈情况的计算逻辑。
4.  `cond_lib.py`: **基础函数库**。提供点数生成、顺位计算、对局是否继续等基础支持。
5.  `rulesets.py`: **规则集定义**。存储了不同麻将规则的顺位马、起始点等关键参数。

## 如何使用

1.  **配置对局状况**: 打开 `main.py` 文件，找到文件底部的 `if __name__ == "__main__":` 部分。
2.  **修改参数**: 根据您需要计算的实际对局情况，修改以下变量：
    - `ruleset_name`: 要使用的规则集名称 (例如 `"ML"`)。
    - `start_pts`: 本场比赛开始前，四位玩家的累计得分。
    - `pts_in_hand`: 当前时刻，四位玩家的持有点数（棒点）。
    - `deposit`: 场上剩余的立直棒数量。
    - `riichi_status`: 一个四元列表，标记哪些玩家已立直 (例如 `[1, 0, 0, 0]`)。
    - `goal_placement`: 您为玩家设定的目标顺位 (例如 `2`，代表进入前二)。
    - `oya`: 当前亲家的座位号 (0-3)。
    - `honba`: 当前的本场数。
3.  **运行脚本**: 在终端中执行命令：
    ```bash
    python main.py
    ```
4.  **查看结果**: 脚本将会在终端中直接打印出为四位玩家计算出的详细条件。

## 练习模式 (Practice Mode)

为了帮助用户熟悉和掌握不同情况下的状况计算，项目还提供了一个交互式的练习工具 `practice.py`。

- **随机场景**: 自动生成符合特定规则的随机对局情况，包括赛前积分、手牌、庄家、本场等。
- **智能提问**: 优先选择非一位的玩家进行提问，使练习更具挑战性和实用性。
- **交互式问答**: 在终端中向用户提问（例如“玩家X为获得前2名，其自摸条件是什么？”），并检验用户输入的答案是否正确。

### 如何使用练习模式

1.  在终端中执行命令：
    ```bash
    python practice.py
    ```
2.  程序会显示一个随机生成的题目。
3.  根据题目计算并输入你的答案。程序会判断答案是否正确并给出提示。

## 依赖

- Python 3.x

该项目的核心计算功能不依赖任何第三方库，是一个纯 Python 实现。